<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>PI Adapter for Azure Event Hubs client settings configuration </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="PI Adapter for Azure Event Hubs client settings configuration ">
    <meta name="generator" content="docfx 2.56.5.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../V1/index.html" width="46">
                <img id="logo" src="../../V1/main/V1/images/atlas_icon.png" height="46" width="46" alt="OSIsoft Edge System"> 
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="PIAdapterForAzureEventHubsClientSettingsConfiguration">
<h1 id="pi-adapter-for-azure-event-hubs-client-settings-configuration">PI Adapter for Azure Event Hubs client settings configuration</h1>

<p>The client settings configuration is automatically generated when a new data source is added. If you experience problems with timeouts or when Azure Event Hubs limits are exceeded in terms of browse or subscription operation, you can change the client settings configuration.</p>
<h2 id="configure-azure-event-hubs-client-settings">Configure Azure Event Hubs client settings</h2>
<p>Complete the following steps to configure the Azure Event Hubs client settings:</p>
<ol>
<li>Using any text editor, create a file that contains the Azure Event Hubs client settings in the JSON format.<ul>
<li>For content structure, see <a href="#azure-event-hubs-client-settings-example">Azure Event Hubs client settings example</a>.</li>
<li>For all available parameters, see <a href="#azure-event-hubs-client-settings-parameters">Azure Event Hubs client settings</a>.</li>
</ul>
</li>
<li>Save the file. For example, <code>ConfigureClientSettings.json</code>.</li>
<li><p>Use any of the <a class="xref" href="../main/V1/Configuration/configuration-tools.html">Configuration tools</a> capable of making HTTP requests to run a <code>PUT</code> command to its appropriate endpoint:</p>
<p> <strong>Note:</strong> The following example uses AzureEventHubs1 as the adapter component name. For more information on how to add a component, see <a class="xref" href="../main/V1/Configuration/system-components-configuration.html">System components configuration</a>.</p>
<p> <code>5590</code> is the default port number. If you selected a different port number, replace it with that value.</p>
<p> <strong>PUT</strong> endpoint: <code>http://localhost:5590/api/v1/configuration/&lt;componentId&gt;/ClientSettings/</code></p>
<p>   Example using <code>curl</code>:</p>
<pre><code class="lang-bash">curl -d &quot;@ConfigureClientSettings.json&quot; -H &quot;Content-Type: application/json&quot; -X PUT &quot;http://localhost:5590/api/v1/configuration/AzureEventHubs1/ClientSettings&quot;
</code></pre><p> <strong>Note:</strong> Run this command from the same directory where the file is located.</p>
</li>
</ol>
<h2 id="azure-event-hubs-client-settings-schema">Azure Event Hubs client settings schema</h2>
<p>The full schema definition for the Azure Event Hubs client settings configuration is in the <code>EventHubs_ClientSettings_schema.json</code> file located in one of the following folders:</p>
<p>Windows: <code>%ProgramFiles%\OSIsoft\Adapters\EventHubs\Schemas</code></p>
<p>Linux: <code>/opt/OSIsoft/Adapters/EventHubs/Schemas</code></p>
<h2 id="azure-event-hubs-client-settings-parameters">Azure Event Hubs client settings parameters</h2>
<p>The following parameters are available for configuring Azure Event Hubs client settings:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Required</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>MaxInternalQueueSize</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>Specifies maximum number of value updates that can be held by the adapter in memory.<br><br>Allowed value: &gt; <code>1000</code><br>Default value: <code>500000</code></td>
</tr>
<tr>
<td><strong>InternalQueuePollingIntervalInMs</strong></td>
<td>Optional</td>
<td><code>string</code><br>(time-span)</td>
<td>Specified interval at which data is removed from internal queue. <br><br>Allowed value: Between <code>1</code> and <code>60000</code> milliseconds<br>Default value: <code>0:00:00.05</code></td>
</tr>
<tr>
<td><strong>TrackLastEnqueuedEventProperties</strong></td>
<td>Optional</td>
<td><code>boolean</code></td>
<td>Indicates if the user should request information on the last enqueued event on the partition associated with a given event, and track that  information as events are received. <br><br>Allowed value: <code>true</code> or <code>false</code> <br>Default value: <code>false</code></td>
</tr>
<tr>
<td><strong>CacheEventCount</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>The maximum amount of events read from the Event Hubs service and held in a local memory cache when reading is active and events are emitted to an enumerator for processing.<br><br>Default value: <code>100</code></td>
</tr>
<tr>
<td><strong>PrefetchCount</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>The number of events requested from the Event Hubs service and staged locally regardless of whether a reader is active. <strong>PrefetchCount</strong> is intended to maximize throughput by buffering service operations. <br><br>Allowed value: Must be greater than <code>2</code> times the <strong>CacheEventCount</strong>.<br>Default value: <code>300</code></td>
</tr>
<tr>
<td><strong>BatchSizeForCheckpoint</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>The number of events processed to trigger a checkpoint operation.<br><br>Default value: <code>500</code></td>
</tr>
<tr>
<td><strong>CheckpointingTimeoutSeconds</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>The timeout in seconds for the checkpoint operation.<br><br>Default value: <code>60</code></td>
</tr>
<tr>
<td><strong>DeviceIdSystemPropertyName</strong></td>
<td>Optional</td>
<td><code>string</code></td>
<td>The name of the system property for the device id.<br><br>Default value: <code>iothub-connection-device-id</code></td>
</tr>
<tr>
<td><strong>EventHubTransportType</strong></td>
<td>Optional</td>
<td><code>enum</code></td>
<td>Identifies the protocol used internally by the client.<br><br>Allowed values: <code>AmqpTcp</code> and <code>AmqpWebSockets</code><br>Default value: <code>AmqpTcp</code></td>
</tr>
<tr>
<td><strong>EventHubLoadBalancingStrategy</strong></td>
<td>Optional</td>
<td><code>enum</code></td>
<td>The load balancing strategy used by the internal Event Hub client used by the adapter. For more information, see Microsoft&#39;s <a href="https://docs.microsoft.com/en-us/dotnet/api/azure.messaging.eventhubs.processor.loadbalancingstrategy?view=azure-dotnet">LoadBalancingStrategy Enum</a>.<br><br><strong>Note:</strong> This setting is irrelevant when you use the recommended Event Hub configuration (single partition).<br><br>Allowed values: <code>Balanced</code> or <code>Greedy</code><br>Default value: <code>Greedy</code></td>
</tr>
<tr>
<td><strong>EventProcessorClientMaximumRetries</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>The maximum amount of retries that the EventProcessorClient makes in case of client failures. <br><br>Default value: <code>5</code></td>
</tr>
<tr>
<td><strong>EventProcessorClientMaximumDelayInMin</strong></td>
<td>Optional</td>
<td><code>integer</code></td>
<td>The maximum delay for the timeout operation in minutes.<br><br>Default value: <code>5</code></td>
</tr>
</tbody>
</table>
<h2 id="azure-event-hubs-client-settings-example">Azure Event Hubs client settings example</h2>
<pre><code class="lang-json">{
   &quot;MaxInternalQueueSize&quot; : 500000,
   &quot;InternalQueuePollingIntervalInMs&quot; : &quot;0:00:00.05&quot;,
   &quot;TrackLastEnqueuedEventProperties&quot; : false,
   &quot;CacheEventCount&quot; : 100,
   &quot;PrefetchCount&quot; : 300,
   &quot;BatchSizeForCheckpoint&quot; : 500,
   &quot;CheckpointingTimeoutSeconds&quot; : 60,
   &quot;DeviceIdSystemPropertyName&quot; : &quot;iothub-connection-device-id&quot;,
   &quot;EventHubTransportType&quot; : &quot;AmqpTcp&quot;,
   &quot;EventHubLoadBalancingStrategy&quot;: &quot;Greedy&quot;,
   &quot;EventProcessorClientMaximumRetries&quot; : 5,
   &quot;EventProcessorClientMaximumDelayInMin&quot; : 5 
}
</code></pre><h2 id="rest-urls">REST URLs</h2>
<table>
<thead>
<tr>
<th>Relative URL</th>
<th>HTTP verb</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/ClientSettings</td>
<td>GET</td>
<td>Retrieves the Azure Event Hubs client settings configuration</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/ClientSettings</td>
<td>PUT</td>
<td>Configures or updates the Azure Event Hubs client settings  configuration</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/ClientSettings</td>
<td>DELETE</td>
<td>Deletes the Azure Event Hubs client settings  configuration</td>
</tr>
<tr>
<td>api/v1/configuration/<em>ComponentId</em>/ClientSettings</td>
<td>PATCH</td>
<td>Allows partial updating of configured client settings fields.</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Replace <em>ComponentId</em> with the Id of your Azure Event Hubs component, for example AzureEventHubs1.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/osisoft/PI-Adapter-Azure-Event-Hubs-Docs/blob/master/V1/Configuration/pi-adapter-for-azure-event-hubs-client-settings-configuration.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span><a href="https://www.osisoft.com/copyright/">© 2019 - 2021 OSIsoft, LLC. All rights reserved.</a></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
